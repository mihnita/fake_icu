name: Release - Create checksums and GPG sign

on:
  workflow_dispatch:
    inputs:
      gitTag:
        # TODO: make this mandatory and validate that it is in a release* branch and looks like
        # 'release-\d+.\d+ or something like that.
        # For now we don't do it so that we can test.
        description: 'Git tag at which to sync for deploy and release'
        type: string

jobs:
  publish:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      packages: write

    steps:

    # For gpg
    - uses: actions/setup-java@v4
      with:
        distribution: 'temurin'
        java-version: '11'

    - name: Get all release files
      run: |
        echo Download everything

    - name: Checksums and sign
      run: |
        echo rm *.asc
        echo rm *.md5
        echo rm SHASUM512.txt

    - name: Upload all release files
      run: |
        echo Upload  everything

    - name: Do we have gpg?
      run: |
        gpg -k
        gpg -K
